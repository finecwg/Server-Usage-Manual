# 증분 백업 및 스냅샷 활용

# 12.3. 증분 백업 및 스냅샷 활용

효과적인 백업 전략을 수립하기 위해서는 증분 백업과 스냅샷을 활용하는 것이 중요합니다. 증분 백업은 마지막 백업 이후 변경된 데이터만 백업하여 백업 시간과 저장 공간을 절약할 수 있습니다. 스냅샷은 특정 시점의 데이터 상태를 캡처하여 빠른 백업과 복구를 가능하게 합니다. 이 문서에서는 증분 백업과 스냅샷의 개념, 장점, 구현 방법 등을 자세히 설명하겠습니다.

## 증분 백업

증분 백업은 마지막 백업 이후 변경된 데이터만 백업하는 방식입니다. 초기에는 전체 백업을 수행하고, 이후에는 변경된 파일만 백업합니다. 증분 백업은 다음과 같은 장점이 있습니다:

- 백업 시간 단축: 변경된 데이터만 백업하므로 전체 백업에 비해 백업 시간이 크게 단축됩니다.
- 저장 공간 절약: 변경된 데이터만 저장하므로 전체 백업에 비해 저장 공간을 효율적으로 사용할 수 있습니다.
- 네트워크 대역폭 절약: 변경된 데이터만 전송하므로 네트워크 대역폭을 효율적으로 사용할 수 있습니다.

### rsync를 사용한 증분 백업 구현

rsync는 Linux에서 널리 사용되는 증분 백업 도구입니다. rsync를 사용하여 증분 백업을 구현하는 방법은 다음과 같습니다:

1. 초기 전체 백업 수행:
    
    ```bash
    rsync -avz --delete /path/to/source/ /path/to/backup/
    
    ```
    
2. 증분 백업 수행:
    
    ```bash
    rsync -avz --delete --link-dest=/path/to/backup/latest /path/to/source/ /path/to/backup/increment/
    
    ```
    
    - `-link-dest` 옵션을 사용하여 이전 백업과 변경되지 않은 파일 간에 하드 링크를 생성합니다.
    - 변경된 파일만 새로 백업되고, 변경되지 않은 파일은 하드 링크로 연결됩니다.
3. 증분 백업 주기에 따라 스크립트를 작성하고 자동화합니다.

### 증분 백업의 고려 사항

증분 백업을 구현할 때는 다음 사항을 고려해야 합니다:

- 복구 시간: 증분 백업은 여러 개의 백업 세트를 사용하므로 복구 시간이 전체 백업에 비해 길어질 수 있습니다.
- 백업 체인 관리: 증분 백업은 백업 체인을 형성하므로 체인 내의 백업이 손상되면 이후의 백업도 사용할 수 없게 됩니다.
- 백업 보관 주기: 증분 백업의 보관 주기를 적절히 설정하여 백업 데이터의 안전성과 저장 공간 사용량의 균형을 맞춰야 합니다.

## 스냅샷

스냅샷은 특정 시점의 데이터 상태를 캡처하는 기술로, 빠른 백업과 복구를 가능하게 합니다. 스냅샷은 데이터의 변경 사항만 기록하므로 저장 공간을 효율적으로 사용할 수 있습니다.

### LVM 스냅샷

LVM(Logical Volume Manager)은 Linux에서 널리 사용되는 볼륨 관리 도구로, 스냅샷 기능을 제공합니다. LVM 스냅샷을 사용하여 백업을 수행하는 방법은 다음과 같습니다:

1. LVM 볼륨 생성:
    
    ```bash
    lvcreate -L 10G -n myvolume vg_name
    
    ```
    
2. 스냅샷 생성:
    
    ```bash
    lvcreate -L 1G -s -n myvolume_snap /dev/vg_name/myvolume
    
    ```
    
    - `s` 옵션을 사용하여 스냅샷을 생성합니다.
    - 스냅샷 볼륨의 크기는 원본 볼륨 크기의 일부로 지정합니다.
3. 스냅샷을 마운트하여 백업 수행:
    
    ```bash
    mount /dev/vg_name/myvolume_snap /mnt/snapshot
    tar -czf backup.tar.gz /mnt/snapshot
    umount /mnt/snapshot
    
    ```
    
4. 스냅샷 삭제:
    
    ```bash
    lvremove /dev/vg_name/myvolume_snap
    
    ```
    

### 파일 시스템 레벨 스냅샷

일부 파일 시스템은 네이티브 스냅샷 기능을 제공합니다. 예를 들어, Btrfs와 ZFS는 파일 시스템 레벨에서 스냅샷을 생성하고 관리할 수 있습니다.

- Btrfs 스냅샷 생성:
    
    ```bash
    btrfs subvolume snapshot /path/to/source /path/to/snapshot
    
    ```
    
- ZFS 스냅샷 생성:
    
    ```bash
    zfs snapshot pool/dataset@snapshot_name
    
    ```
    

파일 시스템 레벨 스냅샷은 LVM 스냅샷과 유사한 방식으로 백업에 활용할 수 있습니다.

### 스냅샷의 고려 사항

스냅샷을 활용할 때는 다음 사항을 고려해야 합니다:

- 스냅샷 저장 공간: 스냅샷은 변경된 데이터를 저장하므로 저장 공간을 추가로 사용합니다.
- 스냅샷 생성 주기: 스냅샷 생성 주기를 적절히 설정하여 백업의 세분성과 저장 공간 사용량의 균형을 맞춰야 합니다.
- 스냅샷 보관 주기: 오래된 스냅샷을 주기적으로 삭제하여 불필요한 저장 공간 사용을 방지해야 합니다.

## 결론

이 문서에서는 증분 백업과 스냅샷을 활용하여 효과적인 백업 전략을 구현하는 방법에 대해 설명했습니다. 증분 백업은 rsync와 같은 도구를 사용하여 변경된 데이터만 백업함으로써 백업 시간과 저장 공간을 절약할 수 있습니다. 스냅샷은 LVM이나 파일 시스템 레벨에서 생성할 수 있으며, 빠른 백업과 복구를 가능하게 합니다. 증분 백업과 스냅샷을 적절히 활용하면 효율적이고 안정적인 백업 체계를 구축할 수 있습니다. 백업 요구 사항과 환경에 맞게 증분 백업과 스냅샷을 선택하고 구현하여 데이터 보호와 비즈니스 연속성을 보장하는 것이 중요합니다.